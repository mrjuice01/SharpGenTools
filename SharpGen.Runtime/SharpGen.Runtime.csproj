<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<!--
		net7.0/net8.0 for full assembly trimming
		net7.0/net8.0 for function pointers codegen and Native(U)Long API surface and partial assembly trimming
		netcoreapp3.0 for smaller [empty] dependency tree (w/o System.Runtime.CompilerServices.Unsafe)
		netstandard2.1 is .NET Core 3.0, but System.Memory is already inbox since 2.1
		netstandard2.0 for smaller dependency tree than netstandard1.3
		net471 for even smaller dependency tree on latest .NET Framework versions (w/o System.Runtime.InteropServices.RuntimeInformation)
		net46 for using proper FormattableString instead of Shim/* version
		-->
		<TargetFrameworks>netstandard2.0;netstandard2.1;netcoreapp3.1;net7.0;net8.0;net461;net471</TargetFrameworks>
		<Description>Support classes for code generated by SharpGen.</Description>
		<AllowUnsafeBlocks>true</AllowUnsafeBlocks>
		<CheckEolTargetFramework>false</CheckEolTargetFramework>
		<IsTrimmable>true</IsTrimmable>
		<EnableTrimAnalyzer>true</EnableTrimAnalyzer>
		<EnableNETAnalyzers>true</EnableNETAnalyzers>
		<AnalysisLevel>preview</AnalysisLevel>
		<PolySharpIncludeRuntimeSupportedAttributes>true</PolySharpIncludeRuntimeSupportedAttributes>
	</PropertyGroup>

	<ItemGroup>
		<PackageReference Include="PolySharp" PrivateAssets="all" />
		<PackageReference Include="System.Memory" Condition="'$(TargetFramework)' != 'net7.0' and '$(TargetFramework)' != 'net8.0' and '$(TargetFramework)' != 'netcoreapp3.1' and '$(TargetFramework)' != 'netstandard2.1'" />
		<PackageReference Include="System.Runtime.CompilerServices.Unsafe" Condition="'$(TargetFramework)' != 'net7.0' and '$(TargetFramework)' != 'net8.0' and '$(TargetFramework)' != 'netcoreapp3.0'" />
		<PackageReference Include="System.Runtime.InteropServices.RuntimeInformation" Condition="'$(TargetFramework)' == 'net45' or '$(TargetFramework)' == 'net461' or '$(TargetFramework)' == 'netstandard1.3'" />
	</ItemGroup>

	<ItemGroup>
		<Content Include="Mapping.xml" PackagePath="build" />
		<Content Include="SharpGen.Runtime.props" PackagePath="build;buildMultiTargeting" />
	</ItemGroup>

	<ItemGroup Condition="'$(TargetFramework)' != 'net45'">
		<Compile Remove="Shim/Formattable*" />
	</ItemGroup>

	<ItemGroup Condition="'$(TargetFramework)' == 'net7.0' OR '$(TargetFramework)' == 'net8.0'">
		<Compile Remove="Shim/ReferenceEqualityComparer.cs" />
	</ItemGroup>

	<ItemGroup>
		<AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleToAttribute">
			<_Parameter1>SharpGen.Runtime.COM, PublicKey=$(SharpGenPublicKey)</_Parameter1>
		</AssemblyAttribute>
	</ItemGroup>


</Project>
